SELECT a.`id`, a.`nomor_surat`, a.`no_document`, a.`kepada`, a.`perihal`, a.`j_lampiran`, a.`jenis_lampiran`, a.`file_lampiran`, a.`isi_surat`, a.`tembusans`, a.`id_divisi`, b.organization_name as divisi, c.created_by, d.first_name, c.id_current_position as jabatan_creator, a.sign_by, if((SELECT COUNT(id) FROM ptpemaco_esign.verif_steps where id_doc=a.no_document and status='rejected')>0,NULL,(SELECT type from ptpemaco_esign.verif_steps where id_doc=a.no_document and status is null order by step ASC limit 1)) as current_type FROM `surats` a, ptpemaco_apam.organizations b, ptpemaco_esign.documents c, ptpemaco_apam.employees d WHERE a.id_divisi=b.organization_id and a.no_document=c.doc_id and c.created_by=d.employe_id;